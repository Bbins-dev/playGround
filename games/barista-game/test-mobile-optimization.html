<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#8B4513">
    <title>ëª¨ë°”ì¼ ìµœì í™” í…ŒìŠ¤íŠ¸ - ë°”ë¦¬ìŠ¤íƒ€ ê²Œì„</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #005a9e;
        }
        .test-result {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .info { color: #17a2b8; }
        .warning { color: #ffc107; }
        .stats-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007acc;
        }
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #007acc;
        }
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
        .device-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .performance-chart {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
        }
        .touch-test-area {
            border: 2px dashed #007acc;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            background: #f8f9fa;
            border-radius: 10px;
            min-height: 200px;
            position: relative;
        }
        .touch-feedback {
            position: absolute;
            width: 50px;
            height: 50px;
            background: rgba(0, 122, 204, 0.3);
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            animation: touchPulse 0.3s ease-out;
        }
        @keyframes touchPulse {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ“± ë°”ë¦¬ìŠ¤íƒ€ ê²Œì„ - ëª¨ë°”ì¼ ìµœì í™” í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h3>1. ë””ë°”ì´ìŠ¤ ì •ë³´</h3>
            <div class="device-info" id="deviceInfo">
                ë””ë°”ì´ìŠ¤ ì •ë³´ë¥¼ ë¡œë”© ì¤‘...
            </div>
            <button class="test-button" onclick="updateDeviceInfo()">ë””ë°”ì´ìŠ¤ ì •ë³´ ìƒˆë¡œê³ ì¹¨</button>
            <div id="deviceResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>2. í„°ì¹˜ ë°˜ì‘ì„± í…ŒìŠ¤íŠ¸</h3>
            <div class="touch-test-area" id="touchTestArea">
                <h4>í„°ì¹˜ ì˜ì—­</h4>
                <p>ì´ ì˜ì—­ì„ í„°ì¹˜í•´ë³´ì„¸ìš”</p>
                <div id="touchFeedback"></div>
            </div>
            <button class="test-button" onclick="testTouchResponsiveness()">í„°ì¹˜ ë°˜ì‘ì„± í…ŒìŠ¤íŠ¸</button>
            <button class="test-button" onclick="clearTouchStats()">í„°ì¹˜ í†µê³„ ì´ˆê¸°í™”</button>
            <div id="touchResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>3. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§</h3>
            <button class="test-button" onclick="startPerformanceMonitoring()">ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì‹œì‘</button>
            <button class="test-button" onclick="stopPerformanceMonitoring()">ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì¤‘ì§€</button>
            <div class="performance-chart" id="performanceChart">
                ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
            </div>
            <div id="performanceResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>4. í™”ë©´ í¬ê¸° ë° ì˜¤ë¦¬ì—”í…Œì´ì…˜ í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testScreenSize()">í™”ë©´ í¬ê¸° í…ŒìŠ¤íŠ¸</button>
            <button class="test-button" onclick="simulateOrientationChange()">ì˜¤ë¦¬ì—”í…Œì´ì…˜ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜</button>
            <button class="test-button" onclick="testResponsiveBreakpoints()">ë°˜ì‘í˜• ë¸Œë ˆì´í¬í¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸</button>
            <div id="screenResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>5. ëª¨ë°”ì¼ ìµœì í™” í†µê³„</h3>
            <button class="test-button" onclick="updateMobileStats()">í†µê³„ ì—…ë°ì´íŠ¸</button>
            <button class="test-button" onclick="clearMobileStats()">í†µê³„ ì´ˆê¸°í™”</button>
            <div class="stats-display" id="mobileStatsDisplay">
                <div class="stat-card">
                    <div class="stat-value" id="avgFPS">60</div>
                    <div class="stat-label">í‰ê·  FPS</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="minFPS">60</div>
                    <div class="stat-label">ìµœì†Œ FPS</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="maxFPS">60</div>
                    <div class="stat-label">ìµœëŒ€ FPS</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="touchCount">0</div>
                    <div class="stat-label">í„°ì¹˜ íšŸìˆ˜</div>
                </div>
            </div>
            <div id="mobileStatsResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>6. ë°°í„°ë¦¬ ë° ì „ë ¥ ìµœì í™”</h3>
            <button class="test-button" onclick="testBatteryOptimization()">ë°°í„°ë¦¬ ìµœì í™” í…ŒìŠ¤íŠ¸</button>
            <button class="test-button" onclick="testVisibilityAPI()">í˜ì´ì§€ ê°€ì‹œì„± API í…ŒìŠ¤íŠ¸</button>
            <button class="test-button" onclick="testNetworkOptimization()">ë„¤íŠ¸ì›Œí¬ ìµœì í™” í…ŒìŠ¤íŠ¸</button>
            <div id="batteryResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>7. ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testBrowserCompatibility()">ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸</button>
            <button class="test-button" onclick="testWebAPISupport()">Web API ì§€ì› í…ŒìŠ¤íŠ¸</button>
            <button class="test-button" onclick="testTouchEvents()">í„°ì¹˜ ì´ë²¤íŠ¸ ì§€ì› í…ŒìŠ¤íŠ¸</button>
            <div id="compatibilityResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>8. ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</h3>
            <button class="test-button" onclick="runAllMobileTests()">ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="allResult" class="test-result"></div>
        </div>
    </div>

    <script src="game.js"></script>
    <script>
        let game;
        let performanceMonitor;
        let touchStats = {
            count: 0,
            lastTouchTime: 0,
            avgResponseTime: 0,
            responseTimes: []
        };
        
        // í…ŒìŠ¤íŠ¸ìš© ê²Œì„ ì¸ìŠ¤í„´ìŠ¤ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            game = window.baristaGame;
            updateDeviceInfo();
            setupTouchTest();
            
            // í™”ë©´ í¬ê¸° ë³€ê²½ ì´ë²¤íŠ¸
            window.addEventListener('resize', updateDeviceInfo);
            window.addEventListener('orientationchange', () => {
                setTimeout(updateDeviceInfo, 100);
            });
        });
        
        function updateDeviceInfo() {
            const deviceInfo = document.getElementById('deviceInfo');
            const isMobile = game ? game.isMobileDevice() : /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isTablet = game ? game.isTabletDevice() : window.innerWidth > 768 && window.innerWidth <= 1024;
            
            deviceInfo.innerHTML = `
                <h4>ë””ë°”ì´ìŠ¤ ì •ë³´</h4>
                <p><strong>ë””ë°”ì´ìŠ¤ íƒ€ì…:</strong> ${isMobile ? 'ëª¨ë°”ì¼' : isTablet ? 'íƒœë¸”ë¦¿' : 'ë°ìŠ¤í¬í†±'}</p>
                <p><strong>í™”ë©´ í¬ê¸°:</strong> ${window.innerWidth} x ${window.innerHeight}</p>
                <p><strong>í™”ë©´ ë¹„ìœ¨:</strong> ${(window.innerWidth / window.innerHeight).toFixed(2)}</p>
                <p><strong>User Agent:</strong> ${navigator.userAgent}</p>
                <p><strong>í„°ì¹˜ ì§€ì›:</strong> ${('ontouchstart' in window) ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}</p>
                <p><strong>ì˜¤ë¦¬ì—”í…Œì´ì…˜:</strong> ${screen.orientation ? screen.orientation.type : 'ì•Œ ìˆ˜ ì—†ìŒ'}</p>
                <p><strong>í”½ì…€ ë°€ë„:</strong> ${window.devicePixelRatio || 1}</p>
            `;
            
            const result = document.getElementById('deviceResult');
            result.textContent = `ë””ë°”ì´ìŠ¤ ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ${isMobile ? 'ëª¨ë°”ì¼' : isTablet ? 'íƒœë¸”ë¦¿' : 'ë°ìŠ¤í¬í†±'} ë””ë°”ì´ìŠ¤ ê°ì§€`;
            result.className = 'test-result success';
        }
        
        function setupTouchTest() {
            const touchArea = document.getElementById('touchTestArea');
            const touchFeedback = document.getElementById('touchFeedback');
            
            touchArea.addEventListener('touchstart', (e) => {
                e.preventDefault();
                handleTouch(e.touches[0], touchArea);
            });
            
            touchArea.addEventListener('mousedown', (e) => {
                handleTouch(e, touchArea);
            });
        }
        
        function handleTouch(touch, container) {
            const rect = container.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            
            // í„°ì¹˜ í”¼ë“œë°± í‘œì‹œ
            const feedback = document.createElement('div');
            feedback.className = 'touch-feedback';
            feedback.style.left = x + 'px';
            feedback.style.top = y + 'px';
            container.appendChild(feedback);
            
            // 0.3ì´ˆ í›„ í”¼ë“œë°± ì œê±°
            setTimeout(() => {
                feedback.remove();
            }, 300);
            
            // í„°ì¹˜ í†µê³„ ì—…ë°ì´íŠ¸
            touchStats.count++;
            const currentTime = performance.now();
            if (touchStats.lastTouchTime > 0) {
                const responseTime = currentTime - touchStats.lastTouchTime;
                touchStats.responseTimes.push(responseTime);
                touchStats.avgResponseTime = touchStats.responseTimes.reduce((a, b) => a + b, 0) / touchStats.responseTimes.length;
            }
            touchStats.lastTouchTime = currentTime;
            
            updateTouchStats();
        }
        
        function updateTouchStats() {
            document.getElementById('touchCount').textContent = touchStats.count;
            
            const result = document.getElementById('touchResult');
            result.textContent = `í„°ì¹˜ í†µê³„:\nì´ í„°ì¹˜ íšŸìˆ˜: ${touchStats.count}\ní‰ê·  ì‘ë‹µ ì‹œê°„: ${touchStats.avgResponseTime.toFixed(2)}ms`;
            result.className = 'test-result info';
        }
        
        function testTouchResponsiveness() {
            const result = document.getElementById('touchResult');
            result.textContent = 'í„°ì¹˜ ë°˜ì‘ì„± í…ŒìŠ¤íŠ¸:\n\n';
            result.className = 'test-result info';
            
            try {
                const avgResponseTime = touchStats.avgResponseTime;
                const isResponsive = avgResponseTime < 100; // 100ms ì´í•˜ë©´ ë°˜ì‘ì„± ì–‘í˜¸
                
                result.textContent += `í‰ê·  ì‘ë‹µ ì‹œê°„: ${avgResponseTime.toFixed(2)}ms\n`;
                result.textContent += `ë°˜ì‘ì„± í‰ê°€: ${isResponsive ? 'ì–‘í˜¸' : 'ê°œì„  í•„ìš”'}\n`;
                result.textContent += `í„°ì¹˜ íšŸìˆ˜: ${touchStats.count}\n`;
                
                if (touchStats.count === 0) {
                    result.textContent += '\ní„°ì¹˜ ì˜ì—­ì„ í„°ì¹˜í•´ë³´ì„¸ìš”.';
                } else {
                    result.textContent += '\ní„°ì¹˜ ë°˜ì‘ì„± í…ŒìŠ¤íŠ¸ ì™„ë£Œ!';
                    result.className = 'test-result success';
                }
            } catch (error) {
                result.textContent = `í„°ì¹˜ ë°˜ì‘ì„± í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function clearTouchStats() {
            touchStats = {
                count: 0,
                lastTouchTime: 0,
                avgResponseTime: 0,
                responseTimes: []
            };
            updateTouchStats();
            
            const result = document.getElementById('touchResult');
            result.textContent = 'í„°ì¹˜ í†µê³„ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.';
            result.className = 'test-result info';
        }
        
        function startPerformanceMonitoring() {
            if (performanceMonitor) {
                clearInterval(performanceMonitor);
            }
            
            let frameCount = 0;
            let lastTime = performance.now();
            const fpsHistory = [];
            
            performanceMonitor = setInterval(() => {
                const currentTime = performance.now();
                const fps = Math.round((frameCount * 1000) / (currentTime - lastTime));
                fpsHistory.push(fps);
                
                // ìµœê·¼ 10ê°œ FPSë§Œ ìœ ì§€
                if (fpsHistory.length > 10) {
                    fpsHistory.shift();
                }
                
                const avgFPS = Math.round(fpsHistory.reduce((a, b) => a + b, 0) / fpsHistory.length);
                const minFPS = Math.min(...fpsHistory);
                const maxFPS = Math.max(...fpsHistory);
                
                document.getElementById('avgFPS').textContent = avgFPS;
                document.getElementById('minFPS').textContent = minFPS;
                document.getElementById('maxFPS').textContent = maxFPS;
                
                const chart = document.getElementById('performanceChart');
                chart.innerHTML = `
                    <h4>ì‹¤ì‹œê°„ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§</h4>
                    <p>í˜„ì¬ FPS: ${fps}</p>
                    <p>í‰ê·  FPS: ${avgFPS}</p>
                    <p>ìµœì†Œ FPS: ${minFPS}</p>
                    <p>ìµœëŒ€ FPS: ${maxFPS}</p>
                    <p>FPS íˆìŠ¤í† ë¦¬: ${fpsHistory.join(', ')}</p>
                `;
                
                frameCount = 0;
                lastTime = currentTime;
            }, 1000);
            
            // ì• ë‹ˆë©”ì´ì…˜ í”„ë ˆì„ ì¹´ìš´í„°
            function countFrame() {
                frameCount++;
                requestAnimationFrame(countFrame);
            }
            countFrame();
            
            const result = document.getElementById('performanceResult');
            result.textContent = 'ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.';
            result.className = 'test-result success';
        }
        
        function stopPerformanceMonitoring() {
            if (performanceMonitor) {
                clearInterval(performanceMonitor);
                performanceMonitor = null;
            }
            
            const chart = document.getElementById('performanceChart');
            chart.innerHTML = 'ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.';
            
            const result = document.getElementById('performanceResult');
            result.textContent = 'ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.';
            result.className = 'test-result info';
        }
        
        function testScreenSize() {
            const result = document.getElementById('screenResult');
            result.textContent = 'í™”ë©´ í¬ê¸° í…ŒìŠ¤íŠ¸:\n\n';
            result.className = 'test-result info';
            
            try {
                const width = window.innerWidth;
                const height = window.innerHeight;
                const ratio = width / height;
                
                let deviceType = 'ë°ìŠ¤í¬í†±';
                if (width <= 480) {
                    deviceType = 'ëª¨ë°”ì¼';
                } else if (width <= 1024) {
                    deviceType = 'íƒœë¸”ë¦¿';
                }
                
                result.textContent += `í™”ë©´ í¬ê¸°: ${width} x ${height}\n`;
                result.textContent += `í™”ë©´ ë¹„ìœ¨: ${ratio.toFixed(2)}\n`;
                result.textContent += `ë””ë°”ì´ìŠ¤ íƒ€ì…: ${deviceType}\n`;
                result.textContent += `í”½ì…€ ë°€ë„: ${window.devicePixelRatio || 1}\n`;
                
                // ë°˜ì‘í˜• ë¸Œë ˆì´í¬í¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
                const breakpoints = [
                    { name: 'ëª¨ë°”ì¼', max: 480 },
                    { name: 'íƒœë¸”ë¦¿', min: 481, max: 1024 },
                    { name: 'ë°ìŠ¤í¬í†±', min: 1025 }
                ];
                
                const currentBreakpoint = breakpoints.find(bp => {
                    if (bp.max && width <= bp.max) return true;
                    if (bp.min && width >= bp.min && (!bp.max || width <= bp.max)) return true;
                    return false;
                });
                
                result.textContent += `í˜„ì¬ ë¸Œë ˆì´í¬í¬ì¸íŠ¸: ${currentBreakpoint ? currentBreakpoint.name : 'ì•Œ ìˆ˜ ì—†ìŒ'}\n`;
                
                result.textContent += '\ní™”ë©´ í¬ê¸° í…ŒìŠ¤íŠ¸ ì™„ë£Œ!';
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `í™”ë©´ í¬ê¸° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function simulateOrientationChange() {
            const result = document.getElementById('screenResult');
            result.textContent = 'ì˜¤ë¦¬ì—”í…Œì´ì…˜ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜:\n\n';
            result.className = 'test-result info';
            
            try {
                // ê°€ìƒ ì˜¤ë¦¬ì—”í…Œì´ì…˜ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜
                const originalWidth = window.innerWidth;
                const originalHeight = window.innerHeight;
                
                result.textContent += `ì›ë³¸ í¬ê¸°: ${originalWidth} x ${originalHeight}\n`;
                
                // ê°€ìƒ í¬ê¸° ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜
                const simulatedWidth = originalHeight;
                const simulatedHeight = originalWidth;
                
                result.textContent += `ì‹œë®¬ë ˆì´ì…˜ í¬ê¸°: ${simulatedWidth} x ${simulatedHeight}\n`;
                result.textContent += `ì˜¤ë¦¬ì—”í…Œì´ì…˜: ${simulatedWidth > simulatedHeight ? 'ê°€ë¡œ' : 'ì„¸ë¡œ'}\n`;
                
                // ì‹¤ì œ ì˜¤ë¦¬ì—”í…Œì´ì…˜ ë³€ê²½ ì´ë²¤íŠ¸ ë°œìƒ
                window.dispatchEvent(new Event('orientationchange'));
                
                result.textContent += '\nì˜¤ë¦¬ì—”í…Œì´ì…˜ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ!';
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `ì˜¤ë¦¬ì—”í…Œì´ì…˜ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜ ì‹¤íŒ¨: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testResponsiveBreakpoints() {
            const result = document.getElementById('screenResult');
            result.textContent = 'ë°˜ì‘í˜• ë¸Œë ˆì´í¬í¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸:\n\n';
            result.className = 'test-result info';
            
            try {
                const breakpoints = [
                    { name: 'ëª¨ë°”ì¼', max: 480, description: 'ìŠ¤ë§ˆíŠ¸í°' },
                    { name: 'íƒœë¸”ë¦¿', min: 481, max: 1024, description: 'íƒœë¸”ë¦¿' },
                    { name: 'ë°ìŠ¤í¬í†±', min: 1025, description: 'ë°ìŠ¤í¬í†±/ë…¸íŠ¸ë¶' }
                ];
                
                const currentWidth = window.innerWidth;
                
                result.textContent += `í˜„ì¬ í™”ë©´ ë„ˆë¹„: ${currentWidth}px\n\n`;
                
                breakpoints.forEach(bp => {
                    let isActive = false;
                    if (bp.max && currentWidth <= bp.max) isActive = true;
                    if (bp.min && currentWidth >= bp.min && (!bp.max || currentWidth <= bp.max)) isActive = true;
                    
                    result.textContent += `${bp.name}: ${isActive ? 'âœ… í™œì„±' : 'âŒ ë¹„í™œì„±'} (${bp.description})\n`;
                    if (bp.min) result.textContent += `  ìµœì†Œ: ${bp.min}px\n`;
                    if (bp.max) result.textContent += `  ìµœëŒ€: ${bp.max}px\n`;
                });
                
                result.textContent += '\në°˜ì‘í˜• ë¸Œë ˆì´í¬í¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!';
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `ë°˜ì‘í˜• ë¸Œë ˆì´í¬í¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function updateMobileStats() {
            try {
                if (game && game.mobileOptimizer) {
                    const stats = game.mobileOptimizer.getMobileStats();
                    
                    document.getElementById('avgFPS').textContent = stats.performance.avgFPS;
                    document.getElementById('minFPS').textContent = stats.performance.minFPS;
                    document.getElementById('maxFPS').textContent = stats.performance.maxFPS;
                    document.getElementById('touchCount').textContent = touchStats.count;
                    
                    const result = document.getElementById('mobileStatsResult');
                    let output = 'ëª¨ë°”ì¼ ìµœì í™” í†µê³„:\n\n';
                    output += `í‰ê·  FPS: ${stats.performance.avgFPS}\n`;
                    output += `ìµœì†Œ FPS: ${stats.performance.minFPS}\n`;
                    output += `ìµœëŒ€ FPS: ${stats.performance.maxFPS}\n`;
                    output += `ë””ë°”ì´ìŠ¤: ${stats.deviceInfo.isMobile ? 'ëª¨ë°”ì¼' : stats.deviceInfo.isTablet ? 'íƒœë¸”ë¦¿' : 'ë°ìŠ¤í¬í†±'}\n`;
                    output += `í™”ë©´ í¬ê¸°: ${stats.deviceInfo.screenWidth}x${stats.deviceInfo.screenHeight}\n`;
                    output += `ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§: ${stats.settings.enablePerformanceMonitoring ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}\n`;
                    output += `ë°°í„°ë¦¬ ìµœì í™”: ${stats.settings.enableBatteryOptimization ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}\n`;
                    output += `ëª©í‘œ FPS: ${stats.settings.targetFPS}\n`;
                    
                    result.textContent = output;
                    result.className = 'test-result success';
                } else {
                    const result = document.getElementById('mobileStatsResult');
                    result.textContent = 'ê²Œì„ì´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
                    result.className = 'test-result warning';
                }
            } catch (error) {
                const result = document.getElementById('mobileStatsResult');
                result.textContent = `ì—ëŸ¬: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function clearMobileStats() {
            touchStats = {
                count: 0,
                lastTouchTime: 0,
                avgResponseTime: 0,
                responseTimes: []
            };
            
            if (performanceMonitor) {
                clearInterval(performanceMonitor);
                performanceMonitor = null;
            }
            
            document.getElementById('performanceChart').innerHTML = 'ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.';
            
            const result = document.getElementById('mobileStatsResult');
            result.textContent = 'ëª¨ë°”ì¼ í†µê³„ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.';
            result.className = 'test-result info';
        }
        
        function testBatteryOptimization() {
            const result = document.getElementById('batteryResult');
            result.textContent = 'ë°°í„°ë¦¬ ìµœì í™” í…ŒìŠ¤íŠ¸:\n\n';
            result.className = 'test-result info';
            
            try {
                if ('getBattery' in navigator) {
                    navigator.getBattery().then((battery) => {
                        result.textContent += `ë°°í„°ë¦¬ ì”ëŸ‰: ${(battery.level * 100).toFixed(1)}%\n`;
                        result.textContent += `ì¶©ì „ ì¤‘: ${battery.charging ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}\n`;
                        result.textContent += `ì¶©ì „ ì‹œê°„: ${battery.chargingTime === Infinity ? 'ì•Œ ìˆ˜ ì—†ìŒ' : battery.chargingTime + 'ì´ˆ'}\n`;
                        result.textContent += `ë°©ì „ ì‹œê°„: ${battery.dischargingTime === Infinity ? 'ì•Œ ìˆ˜ ì—†ìŒ' : battery.dischargingTime + 'ì´ˆ'}\n`;
                        
                        if (battery.level < 0.2) {
                            result.textContent += '\nâš ï¸ ë°°í„°ë¦¬ ì”ëŸ‰ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. ìµœì í™” ëª¨ë“œê°€ ê¶Œì¥ë©ë‹ˆë‹¤.';
                            result.className = 'test-result warning';
                        } else {
                            result.textContent += '\nâœ… ë°°í„°ë¦¬ ìƒíƒœ ì–‘í˜¸';
                            result.className = 'test-result success';
                        }
                    });
                } else {
                    result.textContent += 'ë°°í„°ë¦¬ APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                    result.className = 'test-result warning';
                }
            } catch (error) {
                result.textContent = `ë°°í„°ë¦¬ ìµœì í™” í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testVisibilityAPI() {
            const result = document.getElementById('batteryResult');
            result.textContent = 'í˜ì´ì§€ ê°€ì‹œì„± API í…ŒìŠ¤íŠ¸:\n\n';
            result.className = 'test-result info';
            
            try {
                result.textContent += `í˜„ì¬ ê°€ì‹œì„±: ${document.hidden ? 'ìˆ¨ê¹€' : 'ë³´ì„'}\n`;
                result.textContent += `ê°€ì‹œì„± ìƒíƒœ: ${document.visibilityState}\n`;
                
                // ê°€ì‹œì„± ë³€ê²½ ì´ë²¤íŠ¸ í…ŒìŠ¤íŠ¸
                document.addEventListener('visibilitychange', () => {
                    result.textContent += `\nê°€ì‹œì„± ë³€ê²½: ${document.hidden ? 'ìˆ¨ê¹€' : 'ë³´ì„'}`;
                });
                
                result.textContent += '\nâœ… í˜ì´ì§€ ê°€ì‹œì„± API í…ŒìŠ¤íŠ¸ ì™„ë£Œ!';
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `í˜ì´ì§€ ê°€ì‹œì„± API í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testNetworkOptimization() {
            const result = document.getElementById('batteryResult');
            result.textContent = 'ë„¤íŠ¸ì›Œí¬ ìµœì í™” í…ŒìŠ¤íŠ¸:\n\n';
            result.className = 'test-result info';
            
            try {
                if ('connection' in navigator) {
                    const connection = navigator.connection;
                    result.textContent += `ì—°ê²° íƒ€ì…: ${connection.effectiveType || 'ì•Œ ìˆ˜ ì—†ìŒ'}\n`;
                    result.textContent += `ë‹¤ìš´ë¡œë“œ ì†ë„: ${connection.downlink || 'ì•Œ ìˆ˜ ì—†ìŒ'} Mbps\n`;
                    result.textContent += `RTT: ${connection.rtt || 'ì•Œ ìˆ˜ ì—†ìŒ'} ms\n`;
                    result.textContent += `ë°ì´í„° ì ˆì•½ ëª¨ë“œ: ${connection.saveData ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}\n`;
                    
                    if (connection.effectiveType === 'slow-2g' || connection.effectiveType === '2g') {
                        result.textContent += '\nâš ï¸ ëŠë¦° ë„¤íŠ¸ì›Œí¬ ì—°ê²°. ìµœì í™”ê°€ í•„ìš”í•©ë‹ˆë‹¤.';
                        result.className = 'test-result warning';
                    } else {
                        result.textContent += '\nâœ… ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœ ì–‘í˜¸';
                        result.className = 'test-result success';
                    }
                } else {
                    result.textContent += 'ë„¤íŠ¸ì›Œí¬ ì •ë³´ APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                    result.className = 'test-result warning';
                }
            } catch (error) {
                result.textContent = `ë„¤íŠ¸ì›Œí¬ ìµœì í™” í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testBrowserCompatibility() {
            const result = document.getElementById('compatibilityResult');
            result.textContent = 'ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸:\n\n';
            result.className = 'test-result info';
            
            try {
                const browserInfo = {
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    language: navigator.language,
                    cookieEnabled: navigator.cookieEnabled,
                    onLine: navigator.onLine
                };
                
                result.textContent += `User Agent: ${browserInfo.userAgent}\n`;
                result.textContent += `í”Œë«í¼: ${browserInfo.platform}\n`;
                result.textContent += `ì–¸ì–´: ${browserInfo.language}\n`;
                result.textContent += `ì¿ í‚¤ ì§€ì›: ${browserInfo.cookieEnabled ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}\n`;
                result.textContent += `ì˜¨ë¼ì¸ ìƒíƒœ: ${browserInfo.onLine ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}\n`;
                
                // ë¸Œë¼ìš°ì € ê°ì§€
                let browserName = 'ì•Œ ìˆ˜ ì—†ìŒ';
                if (browserInfo.userAgent.includes('Chrome')) browserName = 'Chrome';
                else if (browserInfo.userAgent.includes('Firefox')) browserName = 'Firefox';
                else if (browserInfo.userAgent.includes('Safari')) browserName = 'Safari';
                else if (browserInfo.userAgent.includes('Edge')) browserName = 'Edge';
                
                result.textContent += `ë¸Œë¼ìš°ì €: ${browserName}\n`;
                
                result.textContent += '\nâœ… ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸ ì™„ë£Œ!';
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testWebAPISupport() {
            const result = document.getElementById('compatibilityResult');
            result.textContent = 'Web API ì§€ì› í…ŒìŠ¤íŠ¸:\n\n';
            result.className = 'test-result info';
            
            try {
                const apis = [
                    { name: 'Touch Events', supported: 'ontouchstart' in window },
                    { name: 'Canvas', supported: !!document.createElement('canvas').getContext },
                    { name: 'Web Audio API', supported: !!window.AudioContext || !!window.webkitAudioContext },
                    { name: 'Performance API', supported: !!window.performance },
                    { name: 'RequestAnimationFrame', supported: !!window.requestAnimationFrame },
                    { name: 'Local Storage', supported: !!window.localStorage },
                    { name: 'Battery API', supported: 'getBattery' in navigator },
                    { name: 'Visibility API', supported: 'visibilityState' in document },
                    { name: 'Network Information API', supported: 'connection' in navigator },
                    { name: 'Device Orientation API', supported: 'onorientationchange' in window }
                ];
                
                apis.forEach(api => {
                    result.textContent += `${api.name}: ${api.supported ? 'âœ… ì§€ì›' : 'âŒ ë¯¸ì§€ì›'}\n`;
                });
                
                const supportedCount = apis.filter(api => api.supported).length;
                const supportRate = (supportedCount / apis.length * 100).toFixed(1);
                
                result.textContent += `\nì§€ì›ë¥ : ${supportRate}% (${supportedCount}/${apis.length})\n`;
                
                if (supportRate >= 80) {
                    result.textContent += 'âœ… Web API ì§€ì› ìƒíƒœ ì–‘í˜¸';
                    result.className = 'test-result success';
                } else {
                    result.textContent += 'âš ï¸ Web API ì§€ì› ìƒíƒœ ê°œì„  í•„ìš”';
                    result.className = 'test-result warning';
                }
            } catch (error) {
                result.textContent = `Web API ì§€ì› í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testTouchEvents() {
            const result = document.getElementById('compatibilityResult');
            result.textContent = 'í„°ì¹˜ ì´ë²¤íŠ¸ ì§€ì› í…ŒìŠ¤íŠ¸:\n\n';
            result.className = 'test-result info';
            
            try {
                const touchEvents = [
                    'touchstart',
                    'touchend',
                    'touchmove',
                    'touchcancel'
                ];
                
                touchEvents.forEach(event => {
                    const supported = `on${event}` in window;
                    result.textContent += `${event}: ${supported ? 'âœ… ì§€ì›' : 'âŒ ë¯¸ì§€ì›'}\n`;
                });
                
                const touchSupported = 'ontouchstart' in window;
                const maxTouchPoints = navigator.maxTouchPoints || 0;
                
                result.textContent += `\ní„°ì¹˜ ì§€ì›: ${touchSupported ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}\n`;
                result.textContent += `ìµœëŒ€ í„°ì¹˜ í¬ì¸íŠ¸: ${maxTouchPoints}\n`;
                
                if (touchSupported) {
                    result.textContent += 'âœ… í„°ì¹˜ ì´ë²¤íŠ¸ ì§€ì› ìƒíƒœ ì–‘í˜¸';
                    result.className = 'test-result success';
                } else {
                    result.textContent += 'âš ï¸ í„°ì¹˜ ì´ë²¤íŠ¸ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                    result.className = 'test-result warning';
                }
            } catch (error) {
                result.textContent = `í„°ì¹˜ ì´ë²¤íŠ¸ ì§€ì› í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function runAllMobileTests() {
            const result = document.getElementById('allResult');
            result.textContent = 'ì „ì²´ ëª¨ë°”ì¼ ìµœì í™” í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘...\n\n';
            result.className = 'test-result info';
            
            setTimeout(() => {
                try {
                    updateDeviceInfo();
                    setTimeout(() => testTouchResponsiveness(), 1000);
                    setTimeout(() => startPerformanceMonitoring(), 2000);
                    setTimeout(() => testScreenSize(), 3000);
                    setTimeout(() => testBatteryOptimization(), 4000);
                    setTimeout(() => testBrowserCompatibility(), 5000);
                    setTimeout(() => testWebAPISupport(), 6000);
                    setTimeout(() => testTouchEvents(), 7000);
                    
                    result.textContent = 'âœ… ëª¨ë“  ëª¨ë°”ì¼ ìµœì í™” í…ŒìŠ¤íŠ¸ ì™„ë£Œ!\n\nê° í…ŒìŠ¤íŠ¸ê°€ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.';
                    result.className = 'test-result success';
                } catch (error) {
                    result.textContent = `âŒ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘ ì—ëŸ¬: ${error.message}`;
                    result.className = 'test-result error';
                }
            }, 100);
        }
        
        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
        window.addEventListener('beforeunload', () => {
            if (performanceMonitor) {
                clearInterval(performanceMonitor);
            }
        });
    </script>
</body>
</html>
