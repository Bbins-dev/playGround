<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì…ë ¥ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ - ë°”ë¦¬ìŠ¤íƒ€ ê²Œì„</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-button {
            background: #007acc;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #005a9e;
        }
        .test-result {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .info { color: #17a2b8; }
        .warning { color: #ffc107; }
        .input-test-area {
            border: 2px dashed #007acc;
            padding: 50px;
            text-align: center;
            margin: 20px 0;
            background: #f8f9fa;
            border-radius: 10px;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        .input-test-area.active {
            background: #e3f2fd;
            border-color: #1976d2;
        }
        .stats-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007acc;
        }
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #007acc;
        }
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ® ë°”ë¦¬ìŠ¤íƒ€ ê²Œì„ - ì…ë ¥ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h3>1. ì…ë ¥ í…ŒìŠ¤íŠ¸ ì˜ì—­</h3>
            <p>ì•„ë˜ ì˜ì—­ì—ì„œ ë§ˆìš°ìŠ¤ í´ë¦­, í„°ì¹˜, í‚¤ë³´ë“œ ì…ë ¥ì„ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.</p>
            <div class="input-test-area" id="inputTestArea">
                <h4>ğŸ¯ ì…ë ¥ í…ŒìŠ¤íŠ¸ ì˜ì—­</h4>
                <p>ë§ˆìš°ìŠ¤ í´ë¦­, í„°ì¹˜, ë˜ëŠ” ìŠ¤í˜ì´ìŠ¤ë°”/ì—”í„°í‚¤ë¥¼ ëˆŒëŸ¬ë³´ì„¸ìš”</p>
                <p><small>í™€ë“œí•˜ê³  ìˆìœ¼ë©´ ì˜ì—­ì´ íŒŒë€ìƒ‰ìœ¼ë¡œ ë³€ê²½ë©ë‹ˆë‹¤</small></p>
            </div>
            <div id="inputResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>2. ì…ë ¥ í†µê³„</h3>
            <button class="test-button" onclick="updateInputStats()">í†µê³„ ì—…ë°ì´íŠ¸</button>
            <button class="test-button" onclick="clearInputStats()">í†µê³„ ì´ˆê¸°í™”</button>
            <div class="stats-display" id="statsDisplay">
                <div class="stat-card">
                    <div class="stat-value" id="totalInputs">0</div>
                    <div class="stat-label">ì´ ì…ë ¥</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="mouseInputs">0</div>
                    <div class="stat-label">ë§ˆìš°ìŠ¤ ì…ë ¥</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="touchInputs">0</div>
                    <div class="stat-label">í„°ì¹˜ ì…ë ¥</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgResponseTime">0ms</div>
                    <div class="stat-label">í‰ê·  ì‘ë‹µì‹œê°„</div>
                </div>
            </div>
            <div id="statsResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>3. ëª¨ë°”ì¼ ìµœì í™” í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testMobileOptimizations()">ëª¨ë°”ì¼ ìµœì í™” í™•ì¸</button>
            <button class="test-button" onclick="testOrientationChange()">ë°©í–¥ ë³€ê²½ í…ŒìŠ¤íŠ¸</button>
            <div id="mobileResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>4. íƒ€ì´ë° ì •í™•ë„ í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testTimingAccuracy()">íƒ€ì´ë° ì •í™•ë„ í…ŒìŠ¤íŠ¸</button>
            <button class="test-button" onclick="testResponseTime()">ì‘ë‹µ ì‹œê°„ í…ŒìŠ¤íŠ¸</button>
            <div id="timingResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>5. ì´ë²¤íŠ¸ ì¤‘ë³µ ë°©ì§€ í…ŒìŠ¤íŠ¸</h3>
            <button class="test-button" onclick="testEventPrevention()">ì´ë²¤íŠ¸ ì¤‘ë³µ ë°©ì§€ í…ŒìŠ¤íŠ¸</button>
            <div id="eventResult" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>6. ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</h3>
            <button class="test-button" onclick="runAllInputTests()">ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <div id="allResult" class="test-result"></div>
        </div>
    </div>

    <script src="game.js"></script>
    <script>
        let testArea;
        let inputStatsInterval;
        
        // í…ŒìŠ¤íŠ¸ ì˜ì—­ ì„¤ì •
        document.addEventListener('DOMContentLoaded', () => {
            testArea = document.getElementById('inputTestArea');
            
            // í…ŒìŠ¤íŠ¸ ì˜ì—­ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            testArea.addEventListener('mousedown', handleTestInput);
            testArea.addEventListener('mouseup', handleTestInput);
            testArea.addEventListener('touchstart', handleTestInput);
            testArea.addEventListener('touchend', handleTestInput);
            
            // ì£¼ê¸°ì ìœ¼ë¡œ í†µê³„ ì—…ë°ì´íŠ¸
            inputStatsInterval = setInterval(updateInputStats, 1000);
        });
        
        function handleTestInput(event) {
            const result = document.getElementById('inputResult');
            const eventType = event.type;
            const timestamp = new Date().toLocaleTimeString();
            
            let message = `[${timestamp}] ${eventType} ì´ë²¤íŠ¸ ê°ì§€\n`;
            
            if (event.type.includes('start') || event.type.includes('down')) {
                testArea.classList.add('active');
                message += 'í™€ë“œ ì‹œì‘\n';
            } else {
                testArea.classList.remove('active');
                message += 'í™€ë“œ ì¢…ë£Œ\n';
            }
            
            if (event.touches) {
                message += `í„°ì¹˜ ê°œìˆ˜: ${event.touches.length}\n`;
            }
            
            result.textContent = message + '\n' + result.textContent;
            result.className = 'test-result info';
            
            // ìë™ ìŠ¤í¬ë¡¤
            result.scrollTop = 0;
        }
        
        function updateInputStats() {
            try {
                const stats = window.getInputStats();
                
                document.getElementById('totalInputs').textContent = stats.totalInputs;
                document.getElementById('mouseInputs').textContent = `${stats.mouseInputs} (${stats.mousePercentage}%)`;
                document.getElementById('touchInputs').textContent = `${stats.touchInputs} (${stats.touchPercentage}%)`;
                document.getElementById('avgResponseTime').textContent = `${stats.averageResponseTime.toFixed(2)}ms`;
                
                const result = document.getElementById('statsResult');
                let output = 'ì…ë ¥ í†µê³„:\n\n';
                output += `ì´ ì…ë ¥: ${stats.totalInputs}\n`;
                output += `ë§ˆìš°ìŠ¤: ${stats.mouseInputs} (${stats.mousePercentage}%)\n`;
                output += `í„°ì¹˜: ${stats.touchInputs} (${stats.touchPercentage}%)\n`;
                output += `í‰ê·  ì‘ë‹µ ì‹œê°„: ${stats.averageResponseTime.toFixed(2)}ms\n`;
                output += `ë§ˆì§€ë§‰ ì‘ë‹µ ì‹œê°„: ${stats.lastResponseTime.toFixed(2)}ms\n`;
                
                result.textContent = output;
                result.className = 'test-result success';
            } catch (error) {
                const result = document.getElementById('statsResult');
                result.textContent = `ì—ëŸ¬: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function clearInputStats() {
            window.baristaGame.inputManager.reset();
            updateInputStats();
            
            const result = document.getElementById('statsResult');
            result.textContent = 'ì…ë ¥ í†µê³„ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.';
            result.className = 'test-result info';
        }
        
        function testMobileOptimizations() {
            const result = document.getElementById('mobileResult');
            let output = 'ëª¨ë°”ì¼ ìµœì í™” í…ŒìŠ¤íŠ¸:\n\n';
            
            try {
                // ë·°í¬íŠ¸ ë©”íƒ€ íƒœê·¸ í™•ì¸
                const viewport = document.querySelector('meta[name="viewport"]');
                output += `ë·°í¬íŠ¸ ë©”íƒ€ íƒœê·¸: ${viewport ? 'âœ… ì¡´ì¬' : 'âŒ ì—†ìŒ'}\n`;
                
                // í„°ì¹˜ ì•¡ì…˜ í™•ì¸
                const touchAction = window.getComputedStyle(testArea).touchAction;
                output += `í„°ì¹˜ ì•¡ì…˜: ${touchAction}\n`;
                
                // ì‚¬ìš©ì ì—ì´ì „íŠ¸ í™•ì¸
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                output += `ëª¨ë°”ì¼ ë””ë°”ì´ìŠ¤: ${isMobile ? 'âœ… ê°ì§€ë¨' : 'âŒ ë°ìŠ¤í¬í†±'}\n`;
                
                // í„°ì¹˜ ì§€ì› í™•ì¸
                const touchSupport = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
                output += `í„°ì¹˜ ì§€ì›: ${touchSupport ? 'âœ… ì§€ì›ë¨' : 'âŒ ì§€ì› ì•ˆë¨'}\n`;
                
                result.textContent = output;
                result.className = 'test-result success';
            } catch (error) {
                result.textContent = `ì—ëŸ¬: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testOrientationChange() {
            const result = document.getElementById('mobileResult');
            let output = result.textContent + '\n\në°©í–¥ ë³€ê²½ í…ŒìŠ¤íŠ¸:\n';
            
            // í˜„ì¬ ë°©í–¥
            const orientation = screen.orientation ? screen.orientation.angle : 'unknown';
            output += `í˜„ì¬ ë°©í–¥: ${orientation}ë„\n`;
            
            // ë°©í–¥ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í…ŒìŠ¤íŠ¸
            const hasOrientationListener = window.baristaGame.inputManager.handleOrientationChange;
            output += `ë°©í–¥ ë³€ê²½ í•¸ë“¤ëŸ¬: ${hasOrientationListener ? 'âœ… ì¡´ì¬' : 'âŒ ì—†ìŒ'}\n`;
            
            result.textContent = output;
            result.className = 'test-result info';
        }
        
        function testTimingAccuracy() {
            const result = document.getElementById('timingResult');
            let output = 'íƒ€ì´ë° ì •í™•ë„ í…ŒìŠ¤íŠ¸:\n\n';
            
            try {
                // performance.now() ì •í™•ë„ í…ŒìŠ¤íŠ¸
                const start = performance.now();
                setTimeout(() => {
                    const end = performance.now();
                    const measured = end - start;
                    const expected = 100; // 100ms
                    const accuracy = Math.abs(measured - expected);
                    
                    output += `ì˜ˆìƒ: ${expected}ms\n`;
                    output += `ì¸¡ì •: ${measured.toFixed(2)}ms\n`;
                    output += `ì˜¤ì°¨: ${accuracy.toFixed(2)}ms\n`;
                    output += `ì •í™•ë„: ${accuracy < 10 ? 'âœ… ìš°ìˆ˜' : accuracy < 50 ? 'âš ï¸ ë³´í†µ' : 'âŒ ë‚˜ì¨'}\n`;
                    
                    result.textContent = output;
                    result.className = accuracy < 10 ? 'test-result success' : 'test-result warning';
                }, 100);
                
                result.textContent = output + 'ì¸¡ì • ì¤‘...';
                result.className = 'test-result info';
            } catch (error) {
                result.textContent = `ì—ëŸ¬: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testResponseTime() {
            const result = document.getElementById('timingResult');
            let output = result.textContent + '\n\nì‘ë‹µ ì‹œê°„ í…ŒìŠ¤íŠ¸:\n';
            
            try {
                const stats = window.getInputStats();
                
                if (stats.totalInputs > 0) {
                    output += `í‰ê·  ì‘ë‹µ ì‹œê°„: ${stats.averageResponseTime.toFixed(2)}ms\n`;
                    output += `ë§ˆì§€ë§‰ ì‘ë‹µ ì‹œê°„: ${stats.lastResponseTime.toFixed(2)}ms\n`;
                    
                    let performance = 'âŒ ë‚˜ì¨';
                    if (stats.averageResponseTime < 16) performance = 'âœ… ìš°ìˆ˜';
                    else if (stats.averageResponseTime < 33) performance = 'âš ï¸ ë³´í†µ';
                    
                    output += `ì„±ëŠ¥ í‰ê°€: ${performance}\n`;
                    
                    result.textContent = output;
                    result.className = stats.averageResponseTime < 16 ? 'test-result success' : 'test-result warning';
                } else {
                    output += 'ì…ë ¥ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì…ë ¥ì„ í…ŒìŠ¤íŠ¸í•´ì£¼ì„¸ìš”.\n';
                    result.textContent = output;
                    result.className = 'test-result info';
                }
            } catch (error) {
                result.textContent = `ì—ëŸ¬: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function testEventPrevention() {
            const result = document.getElementById('eventResult');
            let output = 'ì´ë²¤íŠ¸ ì¤‘ë³µ ë°©ì§€ í…ŒìŠ¤íŠ¸:\n\n';
            
            try {
                // ë¹ ë¥¸ ì—°ì† í´ë¦­ í…ŒìŠ¤íŠ¸
                let clickCount = 0;
                const startTime = Date.now();
                
                const testHandler = () => {
                    clickCount++;
                    if (clickCount >= 5) {
                        const endTime = Date.now();
                        const duration = endTime - startTime;
                        
                        output += `5íšŒ í´ë¦­ ì‹œê°„: ${duration}ms\n`;
                        output += `í‰ê·  ê°„ê²©: ${(duration / 4).toFixed(2)}ms\n`;
                        
                        if (duration < 500) {
                            output += `ê²°ê³¼: âš ï¸ ë„ˆë¬´ ë¹ ë¦„ (ì¤‘ë³µ ë°©ì§€ í•„ìš”)\n`;
                            result.className = 'test-result warning';
                        } else {
                            output += `ê²°ê³¼: âœ… ì ì ˆí•œ ê°„ê²©\n`;
                            result.className = 'test-result success';
                        }
                        
                        result.textContent = output;
                        testArea.removeEventListener('click', testHandler);
                    }
                };
                
                testArea.addEventListener('click', testHandler);
                output += 'ë¹ ë¥´ê²Œ 5íšŒ í´ë¦­í•´ì£¼ì„¸ìš”...\n';
                result.textContent = output;
                result.className = 'test-result info';
                
            } catch (error) {
                result.textContent = `ì—ëŸ¬: ${error.message}`;
                result.className = 'test-result error';
            }
        }
        
        function runAllInputTests() {
            const result = document.getElementById('allResult');
            result.textContent = 'ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘...\n\n';
            result.className = 'test-result info';
            
            setTimeout(() => {
                try {
                    testMobileOptimizations();
                    testTimingAccuracy();
                    updateInputStats();
                    
                    result.textContent = 'âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ ì™„ë£Œ!\n\nê° ì„¹ì…˜ì˜ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”.';
                    result.className = 'test-result success';
                } catch (error) {
                    result.textContent = `âŒ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘ ì—ëŸ¬: ${error.message}`;
                    result.className = 'test-result error';
                }
            }, 100);
        }
        
        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
        window.addEventListener('beforeunload', () => {
            if (inputStatsInterval) {
                clearInterval(inputStatsInterval);
            }
        });
    </script>
</body>
</html>
