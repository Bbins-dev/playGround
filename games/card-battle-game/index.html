<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="auto-battle-card-game-title">Auto Battle Card Dual</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <div class="game-container">
        <!-- 언어 선택기 -->
        <div class="language-selector">
            <select id="languageSelect">
                <option value="ko">🇰🇷</option>
                <option value="en">🇺🇸</option>
                <option value="ja">🇯🇵</option>
            </select>
        </div>

        <!-- 게임 래퍼 (Canvas + UI 오버레이) -->
        <div class="game-wrapper">
            <!-- 메인 캔버스 - 고정 크기 750x960 -->
            <canvas id="gameCanvas" width="750" height="960"></canvas>

            <!-- UI 오버레이 -->
            <div id="ui-overlay" class="ui-overlay">
            <!-- HP 바들 -->
            <div id="enemy-hp-bar" class="hp-bar-container hp-bar-enemy">
                <div class="hp-bar-fill" style="width: 100%;"></div>
                <!-- 방어력 오버레이 -->
                <div class="defense-overlay" style="width: 0%;"></div>
                <div class="hp-bar-text">
                    <span class="hp-info">HP: <span class="hp-number">10/10</span><span class="status-effects" id="enemy-status-effects"></span></span>
                    <span class="entity-name" data-i18n="auto_battle_card_game.ui.enemy">적</span>
                    <span class="defense-info hidden"><span class="defense-number-overlay">0</span></span>
                </div>
            </div>

            <div id="player-hp-bar" class="hp-bar-container hp-bar-player">
                <div class="hp-bar-fill" style="width: 100%;"></div>
                <!-- 방어력 오버레이 -->
                <div class="defense-overlay" style="width: 0%;"></div>
                <div class="hp-bar-text">
                    <span class="hp-info">HP: <span class="hp-number">10/10</span><span class="status-effects" id="player-status-effects"></span></span>
                    <span class="entity-name" data-i18n="auto_battle_card_game.ui.player">플레이어</span>
                    <span class="defense-info hidden"><span class="defense-number-overlay">0</span></span>
                </div>
            </div>

            <!-- 게임 속도 조절 -->
            <div class="speed-controls">
                <button id="speed-1x" class="speed-btn active" data-i18n="auto_battle_card_game.ui.speed_slow">느림</button>
                <button id="speed-2x" class="speed-btn" data-i18n="auto_battle_card_game.ui.speed_normal">보통</button>
                <button id="speed-3x" class="speed-btn" data-i18n="auto_battle_card_game.ui.speed_fast">빠름</button>
            </div>

            <!-- 메인 메뉴 DOM 버튼들 (Canvas 메뉴 대체) -->
            <div id="main-menu-buttons" class="main-menu-container">
                <button class="menu-button" id="start-game-btn">
                    <span class="menu-icon">⚔️</span>
                    <span class="menu-text" data-i18n="auto_battle_card_game.ui.start_game">게임 시작</span>
                </button>
                <button class="menu-button" id="game-tutorial-btn">
                    <span class="menu-icon">📚</span>
                    <span class="menu-text" data-i18n="auto_battle_card_game.ui.game_tutorial">게임 설명</span>
                </button>
                <button class="menu-button" id="card-gallery-menu-btn">
                    <span class="menu-icon">🃏</span>
                    <span class="menu-text" data-i18n="auto_battle_card_game.ui.card_gallery">카드 갤러리</span>
                </button>
                <button class="menu-button" id="back-to-main-menu-btn">
                    <span class="menu-icon">🏠</span>
                    <span class="menu-text" data-i18n="auto_battle_card_game.ui.back_to_homepage">홈페이지로</span>
                </button>
            </div>

            <!-- 카드 갤러리 버튼 -->
            <button id="card-gallery-btn" class="ui-button" data-i18n="auto_battle_card_game.ui.view_all_cards">모든 카드 보기</button>


            <!-- 메뉴화면으로 돌아가기 버튼 -->
            <button id="back-to-menu" class="ui-button back-btn menu-btn" data-i18n="auto_battle_card_game.ui.back_to_menu">←</button>

            <!-- 스테이지 인디케이터 -->
            <div id="stage-indicator" class="stage-indicator hidden">
                <span class="stage-icon">🏆</span>
                <span class="stage-text">Stage 1</span>
                <span class="stage-progress">●○○○○○○○○○</span>
            </div>

            <!-- 턴 인디케이터 (동적으로 생성) -->
            <div id="turn-indicator-container"></div>

            <!-- 대미지/효과 숫자 컨테이너 (동적으로 생성) -->
            <div id="numbers-container"></div>

            <!-- 효과 오버레이 컨테이너 (동적으로 생성) -->
            <div id="effects-container"></div>
        </div>

        <!-- 카드 갤러리 모달 -->
        <div id="card-gallery-modal" class="modal hidden">
            <div class="modal-content glass-morphism">
                <h2 data-i18n="auto_battle_card_game.ui.card_gallery_title">카드 갤러리</h2>
                <div id="card-gallery-grid" class="card-gallery-grid"></div>
                <button id="close-gallery" class="ui-button" data-i18n="auto_battle_card_game.ui.close">닫기</button>
            </div>
        </div>

        <!-- 플레이어 이름 입력 모달 -->
        <div id="player-name-modal" class="modal hidden">
            <div class="modal-content">
                <h2 data-i18n="auto_battle_card_game.ui.enter_player_name">플레이어 이름 입력</h2>
                <div class="name-input-container">
                    <input type="text" id="player-name-input" class="name-input"
                           data-i18n-placeholder="auto_battle_card_game.ui.name_placeholder"
                           placeholder="이름을 입력하세요" maxlength="12">
                </div>
                <div class="modal-buttons">
                    <button id="confirm-name" class="ui-button primary" data-i18n="auto_battle_card_game.ui.confirm">확인</button>
                    <button id="skip-name" class="ui-button secondary" data-i18n="auto_battle_card_game.ui.skip">건너뛰기</button>
                </div>
            </div>
        </div>

        <!-- 카드 선택 모달 -->
        <div id="card-selection-modal" class="modal hidden">
            <div class="modal-content">
                <h2 data-i18n="auto_battle_card_game.ui.select_card">카드 선택</h2>
                <div id="card-selection-grid" class="card-selection-grid"></div>
                <button id="skip-selection" class="ui-button" data-i18n="auto_battle_card_game.ui.skip">건너뛰기</button>
            </div>
        </div>

        <!-- 승리 모달 -->
        <div id="victory-modal" class="modal hidden">
            <div class="modal-content victory-content glass-morphism">
                <div class="victory-header">
                    <h2><span data-i18n="auto_battle_card_game.ui.stage_text">Stage</span> <span id="victory-stage-number">1</span> <span data-i18n="auto_battle_card_game.ui.clear_text">Clear!</span></h2>
                    <p class="victory-reward-text" data-i18n="auto_battle_card_game.ui.choose_reward_card_exclaim">Choose a reward card!</p>
                    <p class="victory-option-text" data-i18n="auto_battle_card_game.ui.reward_options">손패에 추가하거나, 손패 카드와 교체하거나, 스킵 할 수 있습니다</p>
                </div>

                <div class="victory-content-area">

                    <!-- 카드 보상 선택 영역 -->
                    <div id="victory-card-rewards" class="card-rewards-container hidden">
                        <div class="reward-cards-grid">
                            <div class="reward-card" data-card-index="0"></div>
                            <div class="reward-card" data-card-index="1"></div>
                            <div class="reward-card" data-card-index="2"></div>
                        </div>
                        <p class="card-selection-hint" data-i18n="auto_battle_card_game.ui.card_selection_hint">카드 선택 시 확대됩니다</p>
                    </div>

                    <!-- 선택된 카드 확대 표시 영역 -->
                    <div id="selected-card-detail" class="selected-card-detail hidden">
                        <!-- 선택된 카드의 확대 이미지가 여기에 표시됨 -->
                    </div>

                    <!-- 손패 교체 선택 영역 -->
                    <div id="victory-hand-replace" class="hand-replace-container hidden">
                        <p data-i18n="auto_battle_card_game.ui.choose_card_to_replace">교체할 손패 카드를 선택하세요</p>
                        <div class="hand-cards-grid" id="hand-cards-for-replace">
                            <!-- 손패 카드들이 동적으로 표시됨 -->
                        </div>
                        <button id="cancel-replace-btn" class="ui-button secondary" data-i18n="auto_battle_card_game.ui.cancel">취소</button>
                    </div>
                </div>

                <div class="modal-buttons">
                    <!-- 기본 상태: 스킵 버튼과 계속하기 -->
                    <div id="victory-default-buttons" class="button-group">
                        <button id="victory-skip" class="ui-button secondary" data-i18n="auto_battle_card_game.ui.skip_reward">보상 건너뛰기</button>
                        <button id="victory-continue" class="ui-button primary hidden" data-i18n="auto_battle_card_game.ui.continue">계속하기</button>
                    </div>

                    <!-- 카드 선택 후: 덱 추가 또는 교체 선택 -->
                    <div id="victory-selection-buttons" class="button-group hidden">
                        <button id="victory-add-to-deck" class="ui-button primary" data-i18n="auto_battle_card_game.ui.add_to_deck">덱에 추가</button>
                        <button id="victory-replace-card" class="ui-button success" data-i18n="auto_battle_card_game.ui.replace_hand_card">손패와 교체</button>
                        <button id="victory-cancel-selection" class="ui-button" data-i18n="auto_battle_card_game.ui.cancel">취소</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 패배 모달 -->
        <div id="defeat-modal" class="modal hidden">
            <div class="modal-content defeat-content glass-morphism">
                <h2 data-i18n="auto_battle_card_game.ui.defeat_title">게임 오버</h2>
                <div class="defeat-info">
                    <div class="player-info">
                        <p><span data-i18n="auto_battle_card_game.ui.player_name">플레이어:</span> <span id="defeat-player-name">플레이어</span></p>
                        <p><span data-i18n="auto_battle_card_game.ui.final_stage">도달 스테이지:</span> <span id="defeat-final-stage">1</span></p>
                    </div>
                    <div class="game-stats">
                        <h3 data-i18n="auto_battle_card_game.ui.game_statistics">게임 통계</h3>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <span class="stat-label" data-i18n="auto_battle_card_game.ui.total_turns">총 턴수:</span>
                                <span class="stat-value" id="defeat-total-turns">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label" data-i18n="auto_battle_card_game.ui.total_damage_dealt">총 딜량:</span>
                                <span class="stat-value" id="defeat-damage-dealt">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label" data-i18n="auto_battle_card_game.ui.total_damage_received">받은 피해:</span>
                                <span class="stat-value" id="defeat-damage-received">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label" data-i18n="auto_battle_card_game.ui.defense_built">방어력 구축:</span>
                                <span class="stat-value" id="defeat-defense-built">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label" data-i18n="auto_battle_card_game.ui.critical_hits">크리티컬:</span>
                                <span class="stat-value" id="defeat-critical-count">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label" data-i18n="auto_battle_card_game.ui.play_style">플레이 스타일:</span>
                                <span class="stat-value" id="defeat-play-style">균형잡힌</span>
                            </div>
                        </div>
                        <div class="mvp-card" id="defeat-mvp-section">
                            <p><span data-i18n="auto_battle_card_game.ui.mvp_card">MVP 카드:</span> <span id="defeat-mvp-card">-</span></p>
                        </div>
                    </div>
                </div>
                <div class="modal-buttons">
                    <button id="defeat-restart" class="ui-button primary" data-i18n="auto_battle_card_game.ui.try_again">다시 도전하기</button>
                    <button id="defeat-main-menu" class="ui-button secondary" data-i18n="auto_battle_card_game.ui.main_menu">메인 메뉴로</button>
                </div>
            </div>
        </div>

    </div>

    <!-- 스크립트 로드 -->
    <!-- 설정 파일들 먼저 로드 -->
    <script src="js/config/gameConfig.js"></script>
    <!-- i18n 시스템 -->
    <script src="js/i18n.js"></script>
    <!-- 유틸리티 클래스들 -->
    <script src="js/utils/I18nHelper.js"></script>
    <script src="js/utils/CanvasUtils.js"></script>
    <script src="js/utils/TextRenderer.js"></script>
    <script src="js/utils/ColorUtils.js"></script>
    <script src="js/utils/TimerManager.js"></script>
    <script src="js/utils/RenderOptimizer.js"></script>
    <script src="js/config/cardDatabase.js"></script>
    <script src="js/entities/Card.js"></script>
    <script src="js/entities/Player.js"></script>
    <script src="js/entities/Enemy.js"></script>
    <script src="js/ui/HPBarSystem.js"></script>
    <script src="js/ui/EffectSystem.js"></script>
    <script src="js/ui/StageIndicator.js"></script>
    <script src="js/core/GameManager.js"></script>
    <script src="js/core/BattleSystem.js"></script>
    <script src="js/core/CardManager.js"></script>
    <script src="js/ui/CardRenderer.js"></script>
    <script src="js/ui/DOMCardRenderer.js"></script>
    <script src="js/ui/Renderer.js"></script>
    <script src="js/ui/UIManager.js"></script>
    <script src="js/ui/PlayerNameModal.js"></script>
    <script src="js/ui/VictoryDefeatModal.js"></script>
    <script src="js/ui/AnimationManager.js"></script>
    <script src="js/screens/MainMenu.js"></script>
    <script src="js/screens/CardSelection.js"></script>
    <script src="game.js"></script>
</body>
</html>